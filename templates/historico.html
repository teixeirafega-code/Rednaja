<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histórico • MEI Organizado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            background: #05070f;
            color: #e2e8f0;
            font-family: 'Inter', system-ui, sans-serif;
        }

        .card {
            background: #0f172a;
            border: 1px solid #1e2937;
        }

        .chip {
            background: #0b1220;
            border: 1px solid #334155;
        }
    </style>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5CGX5P9EXW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-5CGX5P9EXW');
    </script></head>
<body class="min-h-screen pb-16">

    <nav class="bg-[#0a0f1c] border-b border-slate-800/80 backdrop-blur-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 md:px-8 py-5 flex justify-between items-center">
            <a href="{{ url_for('dashboard') }}" class="flex items-center gap-4">
                <div class="w-9 h-9 bg-emerald-500 rounded-2xl flex items-center justify-center shadow-inner">
                    <img src="{{ url_for('static', filename='images/LOGO-SITE.jpeg') }}" alt="Logo Facilitymei" class="w-full h-full object-cover rounded-2xl">
                </div>
                <div>
                    <span class="text-2xl font-semibold tracking-tighter text-white">Facilitymei</span>
                    <span class="text-[10px] text-emerald-500 font-mono tracking-[2px] block -mt-1">FINANCE</span>
                </div>
            </a>

            <div class="flex items-center gap-6">
                <a href="{{ url_for('dashboard') }}" class="text-slate-300 hover:text-white text-sm font-medium transition">
                    <i class="bi bi-grid mr-1"></i> Painel
                </a>
                <a href="{{ url_for('logout') }}" class="text-slate-400 hover:text-red-400 transition">
                    <i class="bi bi-box-arrow-right text-xl"></i>
                </a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 md:px-8 pt-10">
        <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-8">
            <div>
                <div class="uppercase tracking-[3px] text-emerald-500 text-xs font-medium">Conciliação</div>
                <h1 class="text-4xl md:text-5xl font-semibold tracking-tighter text-white">Histórico</h1>
                <p class="text-slate-400 mt-2">Veja todas as conciliações salvas da sua conta.</p>
            </div>
            <div class="chip rounded-2xl px-4 py-3 text-sm text-slate-300 inline-flex items-center gap-2">
                <i class="bi bi-clock-history text-emerald-400"></i>
                {{ conciliacoes|length }} registro(s)
            </div>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% set ns = namespace(seen=[]) %}
                <div class="space-y-3 mb-6">
                    {% for category, message in messages %}
                        {% if message not in ns.seen %}
                            {% set ns.seen = ns.seen + [message] %}
                            <div class="rounded-2xl px-5 py-4 text-sm border {% if category == 'success' %}bg-emerald-500/10 border-emerald-400/30 text-emerald-200{% elif category == 'danger' %}bg-red-500/10 border-red-400/30 text-red-200{% elif category == 'warning' %}bg-amber-500/10 border-amber-400/30 text-amber-200{% else %}bg-slate-700/40 border-slate-600 text-slate-200{% endif %}">
                                {{ message }}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <div class="card rounded-3xl overflow-hidden">
            {% if conciliacoes %}
                <div class="overflow-x-auto">
                    <table class="w-full min-w-[760px]">
                        <thead class="bg-slate-900/70 border-b border-slate-700">
                            <tr class="text-left text-slate-300 text-xs uppercase tracking-wider">
                                <th class="px-6 py-4">Data</th>
                                <th class="px-6 py-4">Total Extrato</th>
                                <th class="px-6 py-4">Total Vendas</th>
                                <th class="px-6 py-4">Divergência</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for conc in conciliacoes %}
                                <tr class="border-b border-slate-800 hover:bg-slate-800/35 transition-colors">
                                    <td class="px-6 py-4 text-slate-200 whitespace-nowrap">{{ conc[0] }}</td>
                                    <td class="px-6 py-4 text-slate-100 font-medium">{{ conc[1] | default(0) | format_br }}</td>
                                    <td class="px-6 py-4 text-slate-100 font-medium">{{ conc[2] | default(0) | format_br }}</td>
                                    <td class="px-6 py-4 font-semibold {% if conc[3] >= 0 %}text-emerald-400{% else %}text-red-400{% endif %}">
                                        {{ conc[3] | default(0) | format_br }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="p-14 text-center">
                    <div class="w-16 h-16 mx-auto rounded-2xl bg-slate-800 flex items-center justify-center mb-5">
                        <i class="bi bi-inboxes text-3xl text-slate-500"></i>
                    </div>
                    <h2 class="text-2xl font-semibold text-white">Sem conciliações ainda</h2>
                    <p class="text-slate-400 mt-2 mb-8">Faça sua primeira conciliação no painel para começar o histórico.</p>
                    <a href="{{ url_for('dashboard') }}" class="inline-flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 px-6 py-3 rounded-2xl font-semibold text-white transition">
                        <i class="bi bi-lightning-charge-fill"></i>
                        Ir para o painel
                    </a>
                </div>
            {% endif %}
        </div>

        <div class="mt-8 flex justify-center">
            <a href="{{ url_for('dashboard') }}" class="inline-flex items-center gap-2 text-slate-300 hover:text-white transition">
                <i class="bi bi-arrow-left"></i>
                Voltar para o painel
            </a>
        </div>
    </main>
</body>
</html>

